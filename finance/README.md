# ファイナンシャルプランナーエージェント

ローカルLLM（Foundry Local + Phi-4-mini）とクラウドLLM（Azure AI Agent Framework）を組み合わせた**ハイブリッド型ファイナンシャルプランニング支援システム**です。

## 機能

1. **資産分析（ローカル）**: 金融資産データの匿名化・構造化
2. **ライフプラン分析（ローカル）**: 家族構成と将来計画の匿名化・構造化
3. **ファイナンシャルプランニング（クラウド）**: 一般的なアドバイスの生成

## 対応する資産カテゴリ

| カテゴリ | 資産タイプ |
|---------|-----------|
| 現金同等物 | 銀行口座、普通預金、定期預金 |
| 投資有価証券 | NISA成長投資枠、NISA積立投資枠、課税口座株式 |
| 債券 | 国債、社債 |
| 保険商品 | 生命保険、個人年金保険 |

## ハイブリッド構成の利点

| 利点 | 説明 |
|------|------|
| **プライバシー保護** | 具体的な金額、年齢、年収はローカルで処理 |
| **匿名化** | クラウドには割合・カテゴリ情報のみ送信 |
| **低遅延** | ローカル処理による即座の応答 |

## アーキテクチャ

```
ユーザー入力（金融資産 + 家族構成）
    │
    ▼
┌─────────────────────────────────────┐
│   Azure AI Agent Framework          │
│   (ファイナンシャルプランナー)        │
│   - ツール呼び出し判断               │
│   - 統合アドバイス生成               │
└─────────────────────────────────────┘
    │
    ├─ 資産データ → analyze_financial_assets ツール
    │                 │
    │                 ▼ ローカル処理（匿名化）
    │
    ├─ 家族データ → analyze_life_plan ツール
    │                 │
    │                 ▼ ローカル処理（匿名化）
    │
    ▼
┌─────────────────────────────────────┐
│   最終アドバイス生成                 │
│   - 資産配分の評価                   │
│   - ライフステージ考慮事項           │
│   - 免責事項                         │
└─────────────────────────────────────┘
```

## 前提条件

1. **Foundry Localのインストール・起動**
   ```powershell
   winget install Microsoft.FoundryLocal
   foundry model download phi-4-mini
   foundry model load phi-4-mini
   foundry service status  # ポート確認
   ```

2. **Azure CLIログイン**
   ```powershell
   az login
   ```

3. **依存パッケージのインストール**
   ```powershell
   pip install -r requirements.txt
   ```

## 実行方法

```powershell
# プロジェクトルートから実行
python -m finance.agent
```

## サンプル入力

```json
{
  "assets": {
    "bank_savings": {"description": "銀行口座", "amount": 5000000},
    "nisa_growth": {"description": "NISA成長投資枠", "amount": 2400000},
    "nisa_reserve": {"description": "NISA積立投資枠", "amount": 1200000},
    "stocks_non_nisa": {"description": "課税口座の株式", "amount": 3000000},
    "insurance": {"description": "保険", "amount": 800000},
    "government_bonds": {"description": "国債", "amount": 1000000}
  },
  "family": {
    "self": {"age": 45, "occupation": "会社員", "annual_income": 8000000},
    "spouse": {"age": 42, "occupation": "パート", "annual_income": 1200000},
    "children": [
      {"age": 15, "education_stage": "中学3年"},
      {"age": 12, "education_stage": "小学6年"}
    ]
  }
}
```

## サンプル出力

```
=== ファイナンシャルプランナー（ハイブリッド: ローカルツール + クラウドエージェント） ===

## 資産配分の現状分析

### 良い点
- **NISA枠を積極的に活用されています**
  税制優遇口座への投資が全体の約27%を占めています。

- **一定の流動性を確保されています**
  現金・預金が全体の約37%あり、緊急時の備えとして適切な水準です。

### 検討のポイント
- **債券の割合が比較的低めです**
  国債が約7.5%と、年齢層を考慮すると債券比率を検討する余地があります。

### ライフステージを踏まえた考慮事項

1. **短期（1-3年）**: 教育資金確保
2. **中期（4-10年）**: 支出と資産形成のバランス
3. **長期（11-20年）**: 老後資金形成

※この情報は一般的な参考情報であり、投資助言ではありません。
具体的な資産運用については、資格を持つファイナンシャルプランナーや
金融機関にご相談ください。
```

## ファイル構成

```
finance/
├── __init__.py          # パッケージ初期化
├── agent.py             # メインエージェント
├── DESIGN.md            # 設計書
└── README.md            # 本ファイル
```

## 関連ドキュメント

- [設計書](./DESIGN.md) - 詳細なアーキテクチャと技術仕様
- [プロジェクト全体のREADME](../README.md) - ハイブリッドAIプロジェクト概要
